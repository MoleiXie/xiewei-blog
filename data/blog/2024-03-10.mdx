---
title: TCP重传机制、滑动窗口、流量控制、拥塞控制
date: '2024-03-10'
tags: ['Network']
draft: false
summary: '简单介绍了TCP如何进行可靠传输，包含重传机制、滑动窗口、流量控制、拥塞控制等'
---

<TOCInline toc={props.toc} exclude="Introduction" />

#### 1. 重传机制

TCP实现可靠传输的方式之一，是利用序列号与确认应答。

但是网络错综复杂，数据可能在传输过程中丢失了。

那针对这种数据丢失的情况，会用重传机制解决

常见的重传机制：

- 超时重传

  设定一个定时器，在一定时间内没有应答就重发数据包

  注意：**每遇到一次超时重传，都会将下一次超时时间间隔为原先的两倍。两次超时就说明网络环境差，不宜频繁反复发送。**

- 快速重传

  发送方发送了，1、2、3、4、5份数据，

  1数据先到达于是ACK返回2

  结果2因为某些原因没收到，3数据到达，于是还是ACK返回2

  后面4、5都到了，但2还没收到，于是ACK返回2

  **发送端收到了三个ACK = 2的确认，知道了第二份数据没有收到，那就会在定时器过期之前，重传丢失的第二份数据**

- SACK(选择性确认)

  通过SACK可以确认，哪一段数据包丢失

- D-SACK

  主要使用到SACK来告诉发送端，有哪些数据被重复接收了

#### 2. 滑动窗口

TCP每发送一个数据，就要进行一次确认应答。当上一个数据包收到应答再发送下一个。这就像你我面对面你一句我一句，这样效率是比较低的。

如果你说完一句话，我在处理其他事情没有回你，那你岂不是要等到我做完事情之后我回复你，你才能说下一句，很显然这样对于通信而已非常的低效。

为了解决这个问题：

​	TCP引入了窗口，有了窗口就会指定窗口的大小，窗口大小就是指**无需等待确认应答，而可以继续发送数据的最大值**。

#### 3. 流量控制

发送方不能无脑的发数据给接收方，要考虑到接收方处理的能力。

如果一直无脑发数据给对方，对方处理不过来，就会触发`重传机制`，从而造成网络浏览的无端浪费。

为了解决这种现象发送，**TCP提供一种机制可以让`发送方`根据`接收方`的实际接收能力控制发送的数据量，这就是流量控制**。

#### 4. 拥塞控制

计算机网络都是处在一个共享的环境下，因此网络有可能会因为其他主机之间的通信使得网路阻塞。

**如果网络出现拥堵时，继续发送大量的数据包，就可以导致一系列的事故发生，而且这一系列事故还会陷入恶性循环不断地放大**

所有就有了拥塞控制，目的就是在于**避免发送方的数据填满整个网络**。

为了调节发送的数据量，还定义了一个**拥塞窗口**的概念

拥塞窗口是发送方维护的一个状态变量，他会根据**网络的拥塞程度动态变化**.

如果发送了**超时重传**,就会认为**网络出现了拥塞**

拥塞控制主要是四个算法:

- 慢启动

  在通信过程,一点一点的去提高发送的数据量,他是呈现指数增加的.

  他会有一个**阈值(65KB)**,在这个阈值之前会使用慢启动,超过了就会使用拥塞避免算法

  ![TCP](/static/images/TCP.png)

- 拥塞避免

​		在达到慢启动门限, 原本指数增长就变成了线性增长

​		就这样一直增长后就会慢慢进入拥塞的状况了,于是就会出现丢包,当发送		了重传就会进入拥塞发送算法

- 拥塞发送
- 快速恢复